{% extends 'base_content.html'%}
{% block title %}
| {{club.name}}
{% endblock %}
{% block content %}
{% load static %}
{% load define_action %}
{% check_is_owner club current_user as is_owner %}
{% check_is_officer club current_user as is_officer %}
{% check_is_member club current_user as is_member %}
{% check_has_applied club current_user as has_applied %}
{% count_members club as number_of_members%}
{% get_owner club as owner %}
{% get_officers club as officers %}
  <div class="container">
    <div class="row">
      <div class="col-12">
        {%csrf_token%}
        <h1><b>{{ club.name }}</b></h1>
        <P><B>Location: </b> {{ club.location }}</p>
        <p><b>Description: </b> {{ club.description }} </p>
        <p><b>Number of Members: </b> {{ number_of_members }} </p>
        <b>Owner: </b>
        <style>
          .standard-table-spacing{
            vertical-align: middle;
            border-spacing: 10px 2px;
          }
        </style>
        <table class="table standard-table-spacing">
          <tr>
            <th></th>
            <th>Username</th>
            <th>Name</th>
            <th>Email</th>
            <th>Bio</th>
          </tr>
          <tr>
            <td> <img src="{{user.mini_gravatar}}" alt="Gravatar" style="border-radius: 50%"> </td>
            <td> @{{ owner.user.username }} </td>
            <td> {{ owner.user.first_name }} {{ owner.user.last_name }} </td>
            <td> {{ owner.user.email }} </td>

            <td> {{ owner.user.bio }} </td>
            <td></td>
          </tr>
        </table>
        {% if is_member %}
          <b>Officers: </b>
          <table class="table standard-table-spacing">
          {%if officer.count == 0 %}
            <td> No Officers </td>
          {%else%}
            <tr>
              <th></th>
              <th>Username</th>
              <th>Name</th>
              <th>Email</th>
              <th>Bio</th>
            </tr>
              {% for officer in officers %}
            <tr>
              <td> <img src="{{ officer.user.mini_gravatar }}" alt="Gravatar" style="border-radius: 50%"> </td>
              <td> @{{ officer.user.username }} </td>
              <td> {{ officer.user.first_name }} {{ officer.user.last_name }} </td>
              <td> {{ officer.user.email }} </td>
              <td> {{ officer.user.bio }} </td>
            </tr>
              {% endfor %}
            {% endif %}
          </table>
          </br>

            <p></p>
            <td><a href='{% url 'members_list' club.id %}' class="btn btn-primary">Show Members</a></td>
        {%endif%}
        {% if is_owner %}
          <td><a href='{% url 'banned_members' club.id %}' class="btn btn-primary">Banned Members</a></td>
          <td><a href='{% url 'edit_club_info' club.id %}' class="btn btn-primary">Edit</a></td>
          <td><a href='{% url 'show_applications_to_club' club.id %}' class="btn btn-primary">Show Applications</a></td>
          <td><a href='#' class="btn btn-danger">Delete Club</a></td>
        {%endif%}
        {% if is_officer %}
          <td><a href='{% url 'banned_members' club.id %}' class="btn btn-primary">Banned Members</a></td>
          <td><a href='{% url 'show_applications_to_club' club.id %}' class="btn btn-primary">Show Applications</a></td>
        {%endif%}


        <script>
          function confirmWithdrawApplication(){
            if(confirm('Are you sure you want to withdraw your application?')){
              return true;
            }else{
              event.stopPropagation(); event.preventDefault();
            }
          }
          function confirmLeaveClub(){
            if(confirm('Are you sure you want to leave the club?')){
              return true;
            }else{
              event.stopPropagation(); event.preventDefault();
            }
          }
          </script>
          {% if has_applied %}
          <td style="vertical-align: bottom; padding: 20px"><a href='{% url 'withdraw_application_to_club' club.id %}' onclick="confirmWithdrawApplication()" class="btn btn-warning">Withdraw application</a></td>
          {% elif is_member %}
          {% if is_owner %}
          <td style="text-align: center; vertical-align: bottom; padding: 25px"> You are the owner. </td>
          {% else %}
          <td style="vertical-align: bottom; padding: 25px"><a href='{% url 'leave_club' club.id %}' onclick="confirmLeaveClub()" class="btn btn-danger">Leave club</a></td>
          {% endif%}
          {% else %}
          <td style="vertical-align: bottom; padding: 20px"><a href='{% url 'apply_to_club' club.id %}' class="btn btn-success">Apply to club</a></td>
          {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
